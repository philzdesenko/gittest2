{"job":{"components":{"1229701":{"id":1229701,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1949249710,"x":2240,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229750],"outputConnectorIDs":[1229745,1229749],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replicate"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229702":{"id":1229702,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":1040,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229728],"outputConnectorIDs":[1229748],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Order changes for each key"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns.","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"primary_key"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"key_column"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_SEQUENCE_NUMBER"},"2":{"slot":2,"type":"STRING","value":"Desc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"MTLN_CDC_TEMP_KEY_ROW_NUM"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229703":{"id":1229703,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1200,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229748],"outputConnectorIDs":[1229732],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for last change only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_TEMP_KEY_ROW_NUM"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229704":{"id":1229704,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":2640,"y":240,"width":32,"height":32,"inputConnectorIDs":[1229739],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Apply deletes"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_table}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${warehouse}"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${join_expression}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${join_expression}"},"2":{"slot":2,"type":"STRING","value":"Delete"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{},"visible":false},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"alias"},"2":{"slot":2,"type":"GRID","value":"alias"}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229705":{"id":1229705,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-1848704949,"x":2640,"y":80,"width":32,"height":32,"inputConnectorIDs":[1229735],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Apply inserts and updates"}}}},"visible":true},"200":{"slot":200,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_table}"}}}},"visible":true},"201":{"slot":201,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"202":{"slot":202,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"203":{"slot":203,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${warehouse}"}}}},"visible":true},"204":{"slot":204,"name":"Target Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET"}}}},"visible":true},"205":{"slot":205,"name":"Source Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE"}}}},"visible":true},"206":{"slot":206,"name":"Join Expression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${join_expression}"},"2":{"slot":2,"type":"STRING","value":"Join"}}}},"visible":true},"207":{"slot":207,"name":"When Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${join_expression}"},"2":{"slot":2,"type":"STRING","value":"Update"}}}},"visible":true},"208":{"slot":208,"name":"Update Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"target_metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column_name"},"2":{"slot":2,"type":"GRID","value":"column_name"}}}},"visible":true},"209":{"slot":209,"name":"Include Not Matched","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"210":{"slot":210,"name":"Insert Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"target_metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column_name"},"2":{"slot":2,"type":"GRID","value":"column_name"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229706":{"id":1229706,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":2480,"y":80,"width":32,"height":32,"inputConnectorIDs":[1229749],"outputConnectorIDs":[1229735],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter on inserts and updates"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_LAST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"c"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_LAST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"r"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_LAST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"u"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229707":{"id":1229707,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":2480,"y":240,"width":32,"height":32,"inputConnectorIDs":[1229745],"outputConnectorIDs":[1229739],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter on deletes"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_CDC_LAST_CHANGE_TYPE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"d"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229708":{"id":1229708,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":400,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229744],"outputConnectorIDs":[1229730],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract payload and metadata objects"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE \"VALUE\":\"metadata\".\"op\"\n    WHEN 'd' THEN \"VALUE\":\"before\"\n    ELSE \"VALUE\":\"after\"\nEND"},"2":{"slot":2,"type":"STRING","value":"PAYLOAD"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"VALUE\":\"metadata\""},"2":{"slot":2,"type":"STRING","value":"METADATA"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"DATE_HOUR\""},"2":{"slot":2,"type":"STRING","value":"DATE_HOUR"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"\"FILENAME\""},"2":{"slot":2,"type":"STRING","value":"FILENAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"\"VERSION\""},"2":{"slot":2,"type":"STRING","value":"VERSION"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229709":{"id":1229709,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1760,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229734],"outputConnectorIDs":[1229733],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for new data with newer MTLN_CDC_SEQUENCE_NUMBER"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_TARGET_KEY"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"MTLN_TARGET_MTLN_CDC_SEQUENCE_NUMBER"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Less than"},"4":{"slot":4,"type":"STRING","value":"MTLN_CDC_SEQUENCE_NUMBER"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229710":{"id":1229710,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":2000,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229733],"outputConnectorIDs":[1229750],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add batch metadata columns"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CAST(${run_history_id} AS INT)"},"2":{"slot":2,"type":"STRING","value":"MTLN_CDC_LOAD_BATCH_ID"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"CURRENT_TIMESTAMP"},"2":{"slot":2,"type":"STRING","value":"MTLN_CDC_LOAD_TIMESTAMP"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229711":{"id":1229711,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":1440,"y":240,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1229738],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Target table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_table}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"target_metadata"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"column_name"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229724":{"id":1229724,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":0,"y":160,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1229729],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Stage table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${stage_table}"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATABASE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCHEMA"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_HOUR"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAME"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"VALUE"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"VERSION"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${target_database}"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229725":{"id":1229725,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":160,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229729],"outputConnectorIDs":[1229744],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter on source table"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATABASE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${source_database}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SCHEMA"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${source_schema}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"TABLE"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${source_table}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"VERSION"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"${source_version}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"DATE_HOUR"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"${max_date_hour}"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229727":{"id":1229727,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":560,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229730],"outputConnectorIDs":[1229731],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract columns from variant objects"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\t${nested_select_list}\nFROM $T{Extract payload and metadata objects} AS \"EXTRACT PAYLOAD AND METADATA OBJECTS\""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229746":{"id":1229746,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":800,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229731],"outputConnectorIDs":[1229728],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter on high-water mark"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${high_water_mark_target}"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than or equal to"},"4":{"slot":4,"type":"STRING","value":"${high_water_mark}"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1229747":{"id":1229747,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":1600,"y":160,"width":32,"height":32,"inputConnectorIDs":[1229732,1229738],"outputConnectorIDs":[1229734],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join existing data"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter for last change only"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Target table"},"2":{"slot":2,"type":"STRING","value":"TARGET"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${join_expression}"},"2":{"slot":2,"type":"STRING","value":"SOURCE_Left_TARGET"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"join_output"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"input_column"},"2":{"slot":2,"type":"GRID","value":"output_column"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1229728":{"id":1229728,"sourceID":1229746,"targetID":1229702},"1229729":{"id":1229729,"sourceID":1229724,"targetID":1229725},"1229730":{"id":1229730,"sourceID":1229708,"targetID":1229727},"1229731":{"id":1229731,"sourceID":1229727,"targetID":1229746},"1229732":{"id":1229732,"sourceID":1229703,"targetID":1229747},"1229733":{"id":1229733,"sourceID":1229709,"targetID":1229710},"1229734":{"id":1229734,"sourceID":1229747,"targetID":1229709},"1229735":{"id":1229735,"sourceID":1229706,"targetID":1229705},"1229738":{"id":1229738,"sourceID":1229711,"targetID":1229747},"1229739":{"id":1229739,"sourceID":1229707,"targetID":1229704},"1229744":{"id":1229744,"sourceID":1229725,"targetID":1229708},"1229745":{"id":1229745,"sourceID":1229701,"targetID":1229707},"1229748":{"id":1229748,"sourceID":1229702,"targetID":1229703},"1229749":{"id":1229749,"sourceID":1229701,"targetID":1229706},"1229750":{"id":1229750,"sourceID":1229710,"targetID":1229701}},"notes":{"1229713":{"id":1229713,"x":-72,"y":87,"width":308,"height":147,"text":"Read data from change table and filter for source table","colour":"e6e63c"},"1229716":{"id":1229716,"x":2405,"y":166,"width":307,"height":145,"text":"Apply deletes","colour":"e6e63c"},"1229717":{"id":1229717,"x":967,"y":86,"width":309,"height":147,"text":"Find last change for each primary key","colour":"e6e63c"},"1229718":{"id":1229718,"x":727,"y":-154,"width":146,"height":388,"text":"Apply filter on high-water mark to get latest changes\n\nNote, we apply \">=\" here, rather than \">\".  Large updates to the source table may be split across multiple files, with the same high-water mark, and some of these files may be processed by separate job executions.\n\nThe consequence is that we may include some data here which has already been processed.","colour":"e6e63c"},"1229719":{"id":1229719,"x":327,"y":87,"width":308,"height":148,"text":"Extract columns","colour":"e6e63c"},"1229720":{"id":1229720,"x":1367,"y":87,"width":466,"height":226,"text":"Remove any change events where, for a given key,  the MTLN_CDC_SEQUENCE_NUMBER is older than the current value","colour":"e6e63c"},"1229721":{"id":1229721,"x":2164,"y":84,"width":150,"height":149,"text":"Split into two flows","colour":"e6e63c"},"1229722":{"id":1229722,"x":1925,"y":86,"width":150,"height":150,"text":"Add batch metadata columns","colour":"e6e63c"},"1229723":{"id":1229723,"x":2405,"y":5,"width":306,"height":144,"text":"Apply insert and updates","colour":"e6e63c"},"1229726":{"id":1229726,"x":-73,"y":-153,"width":547,"height":149,"text":"**Transformation type = copy table**\n\nExtract latest change events for source table, and apply the last change per primary key value to the target table","colour":"00ce4f"}},"noteConnectors":{},"variables":{"high_water_mark":{"definition":{"name":"high_water_mark","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"high_water_mark_target":{"definition":{"name":"high_water_mark_target","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"join_expression":{"definition":{"name":"join_expression","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"max_date_hour":{"definition":{"name":"max_date_hour","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"nested_select_list":{"definition":{"name":"nested_select_list","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"source_database":{"definition":{"name":"source_database","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"source_schema":{"definition":{"name":"source_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"source_table":{"definition":{"name":"source_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"source_version":{"definition":{"name":"source_version","type":"DECIMAL","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":""},"stage_table":{"definition":{"name":"stage_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_database":{"definition":{"name":"target_database","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_schema":{"definition":{"name":"target_schema","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"target_table":{"definition":{"name":"target_table","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null},"warehouse":{"definition":{"name":"warehouse","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":null}},"grids":{"join_output":{"definition":{"name":"join_output","scope":"TASKBATCH","definitions":[{"name":"input_column","type":"TEXT"},{"name":"output_column","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"primary_key":{"definition":{"name":"primary_key","scope":"TASKBATCH","definitions":[{"name":"key_column","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]},"target_metadata":{"definition":{"name":"target_metadata","scope":"TASKBATCH","definitions":[{"name":"column_name","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"Sync Single Table - 1-2-4-2 - Transform and load","description":"Unpacked from Shared Job [Sync Single Table].","type":"TRANSFORMATION","tag":"6d04c39f-ee97-43ba-b381-ae6ca8382f1a"}}