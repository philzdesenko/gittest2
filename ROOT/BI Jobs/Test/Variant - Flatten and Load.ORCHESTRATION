{"job":{"components":{"1228361":{"id":1228361,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1291941950,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[1228390],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[1228388],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"errorMessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Extract Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${extractDatabase}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${extractSchema}"}}}},"visible":true},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${extractTableName}"}}}},"visible":true},"5":{"slot":5,"name":"Ignore Missing","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228364":{"id":1228364,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":80,"y":160,"width":32,"height":32,"inputConnectorIDs":[1228389],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flatten Variant Error"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"msg = \\\n\"\"\"\nThere was an error flattening the Variant column:\n{}\n\"\"\"\n\n\nraise Exception(msg.format(errorMessage))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228365":{"id":1228365,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1896325668,"x":80,"y":0,"width":32,"height":32,"inputConnectorIDs":[1228384],"outputSuccessConnectorIDs":[1228385],"outputFailureConnectorIDs":[1228389],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"errorMessage"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flatten and Load From Stage"}}}},"visible":true},"2":{"slot":2,"name":"Transformation Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Variant - Flatten"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"extractDatabase"},"2":{"slot":2,"type":"STRING","value":"${extractDatabase}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"extractSchema"},"2":{"slot":2,"type":"STRING","value":"${extractSchema}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"extractTableName"},"2":{"slot":2,"type":"STRING","value":"${extractTableName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"targetDatabase"},"2":{"slot":2,"type":"STRING","value":"${targetDatabase}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"targetSchema"},"2":{"slot":2,"type":"STRING","value":"${targetSchema}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"targetTableName"},"2":{"slot":2,"type":"STRING","value":"${targetTableName}"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"loadWarehouse"},"2":{"slot":2,"type":"STRING","value":"${warehouse}"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"includeInputColumns"},"2":{"slot":2,"type":"STRING","value":"${includeInputColumns}"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"variantColumn"},"2":{"slot":2,"type":"STRING","value":"${variantColumn}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{"1":{"slot":1,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"columnFlattens"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Column"},"2":{"slot":2,"type":"GRID","value":"Property"},"3":{"slot":3,"type":"GRID","value":"Alias"},"4":{"slot":4,"type":"GRID","value":"Outer"},"5":{"slot":5,"type":"GRID","value":"Recursive"},"6":{"slot":6,"type":"GRID","value":"Mode"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"columnFlattening"},"2":{"slot":2,"type":"STRING","value":"grid"}}},"2":{"slot":2,"elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"columnMappings"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"dataValue"},"2":{"slot":2,"type":"GRID","value":"propertyName"},"3":{"slot":3,"type":"GRID","value":"propertyType"},"4":{"slot":4,"type":"GRID","value":"propertyAlias"}}}},"values":{"1":{"slot":1,"type":"STRING","value":"columnMapping"},"2":{"slot":2,"type":"STRING","value":"grid"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228366":{"id":1228366,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-240,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[1228391],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Begin"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228367":{"id":1228367,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":240,"y":0,"width":32,"height":32,"inputConnectorIDs":[1228385],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[1228390],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Extract Tables"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"retainRawData"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"false"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228386":{"id":1228386,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":400,"y":160,"width":32,"height":32,"inputConnectorIDs":[1228388],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Table Error"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"msg = \\\n\"\"\"\nThere was an error dropping the extract table:\n{}\n\"\"\"\n\n\nraise Exception(msg.format(errorMessage))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228387":{"id":1228387,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186960,"x":-80,"y":160,"width":32,"height":32,"inputConnectorIDs":[1228394],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Guess Schema Error"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"msg = \\\n\"\"\"\nThere was an error guessing the Schema:\n{}\n\"\"\"\n\n\nraise Exception(msg.format(errorMessage))"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"1228400":{"id":1228400,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-80,"y":0,"width":32,"height":32,"inputConnectorIDs":[1228391],"outputSuccessConnectorIDs":[1228384],"outputFailureConnectorIDs":[1228394],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"errorMessage","mapTo":"errorMessage"}},"gridExportMappings":{"1":{"slot":1,"fromGrid":"columnMappings","toGrid":"columnMappings","columnMapToFrom":{"dataValue":"dataValue","propertyAlias":"propertyAlias","propertyName":"propertyName","propertyType":"propertyType"}},"2":{"slot":2,"fromGrid":"columnFlattens","toGrid":"columnFlattens","columnMapToFrom":{"Alias":"propertyAlias","Column":"columnName","Mode":"mode","Outer":"outer","Property":"propertyName","Recursive":"recursive"}}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Resolve Schema"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Variant - Detect Schema"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sourceDatabase"},"2":{"slot":2,"type":"STRING","value":"${extractDatabase}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sourceSchema"},"2":{"slot":2,"type":"STRING","value":"${extractSchema}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sourceTableName"},"2":{"slot":2,"type":"STRING","value":"${extractTableName}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"rowScanDepth"},"2":{"slot":2,"type":"STRING","value":"${rowScanDepth}"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"datetimeFormat"},"2":{"slot":2,"type":"STRING","value":"${datetimeFormat}"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"variantColumn"},"2":{"slot":2,"type":"STRING","value":"${variantColumn}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"1228384":{"id":1228384,"sourceID":1228400,"targetID":1228365},"1228385":{"id":1228385,"sourceID":1228365,"targetID":1228367}},"failureConnectors":{"1228388":{"id":1228388,"sourceID":1228361,"targetID":1228386},"1228389":{"id":1228389,"sourceID":1228365,"targetID":1228364},"1228394":{"id":1228394,"sourceID":1228400,"targetID":1228387}},"unconditionalConnectors":{"1228391":{"id":1228391,"sourceID":1228366,"targetID":1228400}},"trueConnectors":{"1228390":{"id":1228390,"sourceID":1228367,"targetID":1228361}},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{"1228360":{"id":1228360,"x":-795,"y":-75,"width":466,"height":148,"text":"**Description**\n\nProvide a Snowflake Table with a Variant Data Type column to be flattened.\n\nThe structure of the Variant column will be guessed and used to create a new table.\n\nIf specified, the source table with the unflattened data will be dropped.\n\n**NB: This is a destructive job and the target table will be recreated each time.**","colour":"00ce4f"}},"variables":{"datetimeFormat":{"definition":{"name":"datetimeFormat","type":"TEXT","scope":"BRANCH","description":"Datetime format to be used when trying to check if a particular value is a TIMESTAMP Data Type.","visibility":"PUBLIC"},"value":"%Y-%m-%dT%H:%M:%SZ"},"errorMessage":{"definition":{"name":"errorMessage","type":"TEXT","scope":"TASKBATCH","description":"Exported Variable - do not set a value. \nIf the job fails, this will be populated with a relevant error message.","visibility":"PUBLIC"},"value":""},"extractDatabase":{"definition":{"name":"extractDatabase","type":"TEXT","scope":"BRANCH","description":"Snowflake Database containing the table to flatten.","visibility":"PUBLIC"},"value":"PZ_DATABASE"},"extractSchema":{"definition":{"name":"extractSchema","type":"TEXT","scope":"BRANCH","description":"Snowflake Schema containing the table to flatten.","visibility":"PUBLIC"},"value":"TRAIN"},"extractTableName":{"definition":{"name":"extractTableName","type":"TEXT","scope":"BRANCH","description":"Snowflake Table containing the raw extract data table.\nThis table is expected at least 1 Variant column which is intended to be expanded.","visibility":"PUBLIC"},"value":"MATILLION_PROJECTS_JSON"},"includeInputColumns":{"definition":{"name":"includeInputColumns","type":"TEXT","scope":"BRANCH","description":"Whether to include the raw un-flattened Variant column in the output Table.\nDefault is No.","visibility":"PUBLIC"},"value":"No"},"retainRawData":{"definition":{"name":"retainRawData","type":"TEXT","scope":"BRANCH","description":"When false, deletes the table which contains the raw API extract","visibility":"PUBLIC"},"value":"true"},"rowScanDepth":{"definition":{"name":"rowScanDepth","type":"DECIMAL","scope":"BRANCH","description":"How many rows should be sampled when attempting to guess the schema of the Variant type.\nIncreasing this value will make the guess more accurate, at the cost of performance.\nDefault 5.","visibility":"PUBLIC"},"value":"5"},"targetDatabase":{"definition":{"name":"targetDatabase","type":"TEXT","scope":"BRANCH","description":"Snowflake Database to store the table containing the flattened results.","visibility":"PUBLIC"},"value":"PZ_DATABASE"},"targetSchema":{"definition":{"name":"targetSchema","type":"TEXT","scope":"BRANCH","description":"Snowflake Schema to store the table containing the flattened results.","visibility":"PUBLIC"},"value":"TRAIN"},"targetTableName":{"definition":{"name":"targetTableName","type":"TEXT","scope":"BRANCH","description":"Name of the table to create and store the flattened data inside.\nNB: This is a destructive component and this table will be recreated each time.","visibility":"PUBLIC"},"value":"MATILLION_PROJECTS_JSON_TEST"},"variantColumn":{"definition":{"name":"variantColumn","type":"TEXT","scope":"BRANCH","description":"Name of the VARIANT type column in the source table to be flattened.\nDefault is Data Value.","visibility":"PUBLIC"},"value":"JSON_PROJECT"},"warehouse":{"definition":{"name":"warehouse","type":"TEXT","scope":"BRANCH","description":"Snowflake Warehouse to use to process data.","visibility":"PUBLIC"},"value":"TEST_WH"}},"grids":{"columnFlattens":{"definition":{"name":"columnFlattens","scope":"TASKBATCH","definitions":[{"name":"Column","type":"TEXT"},{"name":"Property","type":"TEXT"},{"name":"Alias","type":"TEXT"},{"name":"Outer","type":"TEXT"},{"name":"Recursive","type":"TEXT"},{"name":"Mode","type":"TEXT"}],"description":"Exported Variable - do not set a value for this.\nDescribes how columns/properties should be flattened according to the Matillion ETL for Snowflake Flatten Variant Component.","visibility":"PUBLIC"},"values":[]},"columnMappings":{"definition":{"name":"columnMappings","scope":"TASKBATCH","definitions":[{"name":"dataValue","type":"TEXT"},{"name":"propertyName","type":"TEXT"},{"name":"propertyType","type":"TEXT"},{"name":"propertyAlias","type":"TEXT"}],"description":"Exported Variable - do not set a value for this.\nDescribes how columns/properties should be mapped according to the Matillion ETL for Snowflake Flatten Variant Component.","visibility":"PUBLIC"},"values":[]}}},"info":{"name":"Variant - Flatten and Load","description":"Unpacked from Shared Job [Flatten and Load].","type":"ORCHESTRATION","tag":"10376709-b816-4a28-9d32-ca08e3d2b9e8"}}