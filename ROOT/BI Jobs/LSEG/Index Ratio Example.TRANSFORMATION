{"job":{"components":{"1234813":{"id":1234813,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":43,"y":384,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1234869],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"xml_test"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"XML_TEST"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"XML_FILE"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1234864":{"id":1234864,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":208,"y":384,"width":32,"height":32,"inputConnectorIDs":[1234869],"outputConnectorIDs":[1234868],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake XGET Query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \nXMLGET(control.value,'report_date'):\"$\"::datetime report_date\n,XMLGET(control.value,'recordcount'):\"$\"::integer recordcount\n,record.value::string as record\n\nFROM \n  XML_TEST test\n  ,LATERAL FLATTEN(TO_ARRAY(test.XML_FILE:\"$\")) docs \n  ,LATERAL FLATTEN(TO_ARRAY(docs.value:\"$\")) control\n  ,LATERAL FLATTEN(TO_ARRAY(docs.value:\"$\")) content\n  ,LATERAL FLATTEN(TO_ARRAY(content.value:\"$\")) records\n  ,LATERAL FLATTEN(TO_ARRAY(records.value:\"$\")) record\nWHERE \n  GET(docs.value, '@') = 'document:msg' and\n  GET(control.value, '@') = 'control'  and\n  GET(content.value, '@') = 'content' "}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1234865":{"id":1234865,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":720,"y":384,"width":32,"height":32,"inputConnectorIDs":[1234871],"outputConnectorIDs":[1234875],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert Type 0"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INDEX_RATIO"},"2":{"slot":2,"type":"STRING","value":"FLOAT"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SETTLEMENT_DATE"},"2":{"slot":2,"type":"STRING","value":"TIMESTAMP"},"3":{"slot":3,"type":"INTEGER","value":""},"4":{"slot":4,"type":"INTEGER","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ISIN_CODE"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"INTEGER","value":"20"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1234866":{"id":1234866,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":896,"y":384,"width":32,"height":32,"inputConnectorIDs":[1234875],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Select columns"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"REPORT_DATE"},"2":{"slot":2,"type":"STRING","value":"REPORT_DATE"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"RECORDCOUNT"},"2":{"slot":2,"type":"STRING","value":"RECORDCOUNT"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"INDEX_RATIO"},"2":{"slot":2,"type":"STRING","value":"INDEX_RATIO"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ISIN_CODE"},"2":{"slot":2,"type":"STRING","value":"ISIN_CODE"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"SETTLEMENT_DATE"},"2":{"slot":2,"type":"STRING","value":"SETTLEMENT_DATE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1234867":{"id":1234867,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1844569003,"x":384,"y":384,"width":32,"height":32,"inputConnectorIDs":[1234868],"outputConnectorIDs":[1234874],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Split Record on space"}}}},"visible":true},"2":{"slot":2,"name":"Input Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"RECORD"}}}},"visible":true},"3":{"slot":3,"name":"Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":" "}}}},"visible":true},"4":{"slot":4,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"},"2":{"slot":2,"type":"STRING","value":"ignore"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"INTEGER","value":"2"},"2":{"slot":2,"type":"STRING","value":"INDEX_RATIO"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"},"2":{"slot":2,"type":"STRING","value":"ISIN_CODE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"INTEGER","value":"4"},"2":{"slot":2,"type":"STRING","value":"SETTLEMENT_DATE"}}}},"visible":true},"5":{"slot":5,"name":"Include Input Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1234870":{"id":1234870,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":544,"y":384,"width":32,"height":32,"inputConnectorIDs":[1234874],"outputConnectorIDs":[1234871],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Extract values from Record"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SUBSTRING(\"INDEX_RATIO\",CHARINDEX('\"',\"INDEX_RATIO\")+1, CHARINDEX('\"',\"INDEX_RATIO\",CHARINDEX('\"',\"INDEX_RATIO\")+1)-CHARINDEX('\"',\"INDEX_RATIO\")-1) "},"2":{"slot":2,"type":"STRING","value":"INDEX_RATIO"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"SUBSTRING(\"ISIN_CODE\",CHARINDEX('\"',\"ISIN_CODE\")+1, CHARINDEX('\"',\"ISIN_CODE\",CHARINDEX('\"',\"ISIN_CODE\")+1)-CHARINDEX('\"',\"ISIN_CODE\")-1) "},"2":{"slot":2,"type":"STRING","value":"ISIN_CODE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SUBSTRING(\"SETTLEMENT_DATE\",CHARINDEX('\"',\"SETTLEMENT_DATE\")+1, CHARINDEX('\"',\"SETTLEMENT_DATE\",CHARINDEX('\"',\"SETTLEMENT_DATE\")+1)-CHARINDEX('\"',\"SETTLEMENT_DATE\")-1) "},"2":{"slot":2,"type":"STRING","value":"SETTLEMENT_DATE_STRING"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"substring(\"SETTLEMENT_DATE_STRING\",1,10)::datetime"},"2":{"slot":2,"type":"STRING","value":"SETTLEMENT_DATE"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1234868":{"id":1234868,"sourceID":1234864,"targetID":1234867},"1234869":{"id":1234869,"sourceID":1234813,"targetID":1234864},"1234871":{"id":1234871,"sourceID":1234870,"targetID":1234865},"1234874":{"id":1234874,"sourceID":1234867,"targetID":1234870},"1234875":{"id":1234875,"sourceID":1234865,"targetID":1234866}},"notes":{"1234812":{"id":1234812,"x":38,"y":80,"width":806,"height":250,"text":"**``From SNOWSQL``**\n\nIn this Example...\n\n1) I place the file into a named internal stage called MATILLION_PROJECTS\n\nput file://c:\\mytest\\indexratio.xml @MATILLION_PROJECTS;\n\n**``Within Snowflake Console``**\n\n2) Copy the file from the named stage into a table named XML_TEST which has one column of type Variant.\n\nCOPY INTO XML_TEST\nFROM @MATILLION_PROJECTS\nFILE_FORMAT=(TYPE=XML) ON_ERROR='CONTINUE';\n\n3) then run ETL job.","colour":"e6e63c"},"1234815":{"id":1234815,"x":876,"y":77,"width":337,"height":120,"text":"**``Alternative method``**\n\n1) Place the file into a s3 bucket.\n2) Use a 's3 Load' component in an orchestration job to load the file into a table with a variant column.\n","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"Index Ratio Example","description":"","type":"TRANSFORMATION","tag":"88045b22-dc6f-47f8-a1e7-8a88f3a55872"}}