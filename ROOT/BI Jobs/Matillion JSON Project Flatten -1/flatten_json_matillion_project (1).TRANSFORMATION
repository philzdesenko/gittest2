{"job":{"components":{"80662":{"id":80662,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":-32,"y":272,"width":32,"height":32,"inputConnectorIDs":[80669],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_JSON_FLATTENED"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_JSON_FLATTENED"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PZ_DATABASE"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRAIN"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"80664":{"id":80664,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":-32,"y":-176,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[80668],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_PROJECTS_JSON"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MATILLION_PROJECTS_JSON"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JSON_PROJECT"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRAIN"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PZ_DATABASE"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"80665":{"id":80665,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":416069678,"x":-32,"y":-64,"width":32,"height":32,"inputConnectorIDs":[80668],"outputConnectorIDs":[80671],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flatten PROJECT JSON"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"objects"},"2":{"slot":2,"type":"STRING","value":"description"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"Version"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"info:id"},"3":{"slot":3,"type":"STRING","value":"NUMBER"},"4":{"slot":4,"type":"STRING","value":"JobID"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"info:name"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"JobName"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"jobObject:JobType"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"JobType"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"jobObject:created"},"3":{"slot":3,"type":"STRING","value":"NUMBER"},"4":{"slot":4,"type":"STRING","value":"DateCreated"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"jobObject:timestamp"},"3":{"slot":3,"type":"STRING","value":"NUMBER"},"4":{"slot":4,"type":"STRING","value":"Timestamp_DT"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"path"},"3":{"slot":3,"type":"STRING","value":"VARIANT"},"4":{"slot":4,"type":"STRING","value":"JobPath"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"components"},"2":{"slot":2,"type":"STRING","value":"implementationID"},"3":{"slot":3,"type":"STRING","value":"NUMBER"},"4":{"slot":4,"type":"STRING","value":"ComponentID"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"components"},"2":{"slot":2,"type":"STRING","value":"executionHint"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"ComponentType"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"parameters"},"2":{"slot":2,"type":"STRING","value":"name"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"ComponentName"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"elementValues"},"2":{"slot":2,"type":"STRING","value":"value"},"3":{"slot":3,"type":"STRING","value":"VARCHAR"},"4":{"slot":4,"type":"STRING","value":"ComponentValue"}}}},"visible":true},"3":{"slot":3,"name":"Column Flattens","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JSON_PROJECT"},"2":{"slot":2,"type":"STRING","value":"objects"},"3":{"slot":3,"type":"STRING","value":"objects"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"objects"},"2":{"slot":2,"type":"STRING","value":"jobs.objects"},"3":{"slot":3,"type":"STRING","value":"jobs"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"jobs"},"2":{"slot":2,"type":"STRING","value":"jobObject.components"},"3":{"slot":3,"type":"STRING","value":"components"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"components"},"2":{"slot":2,"type":"STRING","value":"parameters"},"3":{"slot":3,"type":"STRING","value":"parameters"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"parameters"},"2":{"slot":2,"type":"STRING","value":"elements"},"3":{"slot":3,"type":"STRING","value":"elements"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"elements"},"2":{"slot":2,"type":"STRING","value":"values"},"3":{"slot":3,"type":"STRING","value":"elementValues"},"4":{"slot":4,"type":"STRING","value":"false"},"5":{"slot":5,"type":"STRING","value":"false"},"6":{"slot":6,"type":"STRING","value":"both"}}}},"visible":true},"4":{"slot":4,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"80666":{"id":80666,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1838652813,"x":-32,"y":48,"width":32,"height":32,"inputConnectorIDs":[80671],"outputConnectorIDs":[80670],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Convert Type 0"}}}},"visible":true},"2":{"slot":2,"name":"Conversions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ComponentID"},"2":{"slot":2,"type":"STRING","value":"NUMBER"},"3":{"slot":3,"type":"INTEGER","value":"10"},"4":{"slot":4,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"80667":{"id":80667,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":-32,"y":160,"width":32,"height":32,"inputConnectorIDs":[80670],"outputConnectorIDs":[80669],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Transform EPOCH dates & ETL Path"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DATEADD(MS, \"DateCreated\", 0::TIMESTAMP)"},"2":{"slot":2,"type":"STRING","value":"DateCreated"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATEADD(MS, \"Timestamp_DT\", 0::TIMESTAMP)"},"2":{"slot":2,"type":"STRING","value":"Timestamp_DT"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"array_to_string(\"JobPath\",'/')"},"2":{"slot":2,"type":"STRING","value":"JobPath"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"80668":{"id":80668,"sourceID":80664,"targetID":80665},"80669":{"id":80669,"sourceID":80667,"targetID":80662},"80670":{"id":80670,"sourceID":80666,"targetID":80667},"80671":{"id":80671,"sourceID":80665,"targetID":80666}},"notes":{"80660":{"id":80660,"x":-721,"y":-134,"width":462,"height":444,"text":"**``Postman command``**\n\nGET http://emerald-ha.matillion.com/rest/v1/group/name/Implementation%20Team%20Development/project/name/Iora%20Health%20Migration/version/name/default/export\n\n``SF query used to  construct Flatten Variant component properties``\n\nSELECT \n    objects.value:description::string as version  \n    ,jobs.value:info:name::string as JobName\n    ,jobs.value:jobObject:JobType::string as JobType\n    ,jobs.value:jobObject:created::number as DateCreated\n    ,jobs.value:jobObject:timestamp::number as TimeStamp    \n    ,jobs.value:info:id::number as JobId\n    ,components.value:implementationID::number as ComponentId\n    ,parameters.value:name::string as ComponentName\n    ,elementValues.value:value::string as ComponentValue          \n    \n    ,array_to_string(jobs.value:path,'/')\nFROM \n\tMATILLION_PROJECTS_JSON,\n\tlateral flatten(JSON_PROJECT:objects) as objects,\n    lateral flatten(objects.value:jobs:objects) as jobs,\n    lateral flatten(jobs.value:jobObject:components) as components,\n    lateral flatten(components.value:parameters) as parameters,\n    lateral flatten(parameters.value:elements) as elements,    \n      lateral flatten(elements.value:values) as elementValues  ","colour":"e6e63c"},"80663":{"id":80663,"x":174,"y":-113,"width":1077,"height":286,"text":"Steps to get JSON into a table\n\n1. Run the postman command above and download the export to a JSON file.\n2. Do the following in SF console and Snowsql;\n\n    \n/*\ncreate a table with variant column\n\nCREATE STAGE \"PZ_DATABASE\".\"TRAIN\".MATILLION_PROJECTS;\n\nfrom snowsql:  put file://C:\\Users\\Phil.Zdesenko\\Downloads\\Response.json @MATILLION_PROJECTS;\n\ncreate or replace file format json_format\n  type = 'JSON'\n  strip_outer_element = true;\n  \ncopy into MATILLION_PROJECTS(PROJECT_NAME,JSON_PROJECT) FROM (SELECT 'Iora Health',t1.$1 from @matillion_projects/Response.json.gz t1) file_format = (format_name = json_format);\n*/","colour":"00ce4f"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"flatten_json_matillion_project (1)","description":"","type":"TRANSFORMATION","tag":"de34844f-5b45-41eb-8b82-8c9578bb39f0"}}