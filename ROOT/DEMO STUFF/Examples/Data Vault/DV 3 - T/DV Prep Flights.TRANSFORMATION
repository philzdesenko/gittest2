{"job":{"components":{"1238292":{"id":1238292,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":752,"y":160,"width":32,"height":32,"inputConnectorIDs":[1238278],"outputConnectorIDs":[1238273],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter valid only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dq_indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238293":{"id":1238293,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1468,"y":160,"width":32,"height":32,"inputConnectorIDs":[1238279],"outputConnectorIDs":[1238274],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ux_flightnum"},"2":{"slot":2,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ux_origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ux_dest"},"2":{"slot":2,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ux_date"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ux_deptime"},"2":{"slot":2,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"plane_tailnum"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238294":{"id":1238294,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":962,"y":162,"width":32,"height":32,"inputConnectorIDs":[1238273],"outputConnectorIDs":[1238277],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add dup counter"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"ux_flightnum\", \"ux_origin\", \"ux_dest\", \"ux_date\", \"ux_deptime\"\n                   ORDER BY \"ux_flightnum\")"},"2":{"slot":2,"type":"STRING","value":"dup_seq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238295":{"id":1238295,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1296,"y":160,"width":32,"height":32,"inputConnectorIDs":[1238275],"outputConnectorIDs":[1238279],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delayed Flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"sched_dep\" IS NULL OR \"sched_arr\" IS NULL\n          THEN false\n     WHEN \"actual_dep\" IS NULL OR \"actual_arr\" IS NULL\n          THEN false\n     WHEN TO_NUMBER(\"actual_arr\") - TO_NUMBER(\"sched_arr\") > 15\n     \t  THEN true\n     ELSE\n          false\nEND"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238296":{"id":1238296,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1631,"y":159,"width":32,"height":32,"inputConnectorIDs":[1238274],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite Table 0"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238297":{"id":1238297,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":624,"y":160,"width":32,"height":32,"inputConnectorIDs":[1238272],"outputConnectorIDs":[1238278],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Must have a business key"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"ux_flightnum\" IS NOT NULL\n      AND \"ux_origin\" IS NOT NULL\n      AND \"ux_dest\" IS NOT NULL\n      AND \"ux_date\" IS NOT NULL\n      AND \"ux_deptime\" IS NOT NULL\n     THEN 1\n     ELSE 0\nEND"},"2":{"slot":2,"type":"STRING","value":"dq_indicator"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238298":{"id":1238298,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1120,"y":160,"width":32,"height":32,"inputConnectorIDs":[1238277],"outputConnectorIDs":[1238275],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove dups"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dup_seq"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238299":{"id":1238299,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":483,"y":164,"width":32,"height":32,"inputConnectorIDs":[1238276],"outputConnectorIDs":[1238272],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate derived fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(\"flightnum\")"},"2":{"slot":2,"type":"STRING","value":"ux_flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"origin\""},"2":{"slot":2,"type":"STRING","value":"ux_origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"dest\""},"2":{"slot":2,"type":"STRING","value":"ux_dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CONCAT(\"year\", '-', LPAD(\"month\",2,0), '-', LPAD(\"dayofmonth\",2,0))"},"2":{"slot":2,"type":"STRING","value":"ux_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"LPAD(COALESCE(\"crsdeptime\",REPLACE(\"deptime\",'NA','0')),4,0)"},"2":{"slot":2,"type":"STRING","value":"ux_deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(TRIM(\"tailnum\"), '')"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"crsdeptime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"deptime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"crsarrtime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(REPLACE(\"arrtime\",'NA','0'),4,0))"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1238300":{"id":1238300,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":242,"y":157,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1238276],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"month"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dayofmonth"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"crsdeptime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crsarrtime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1238272":{"id":1238272,"sourceID":1238299,"targetID":1238297},"1238273":{"id":1238273,"sourceID":1238292,"targetID":1238294},"1238274":{"id":1238274,"sourceID":1238293,"targetID":1238296},"1238275":{"id":1238275,"sourceID":1238298,"targetID":1238295},"1238276":{"id":1238276,"sourceID":1238300,"targetID":1238299},"1238277":{"id":1238277,"sourceID":1238294,"targetID":1238298},"1238278":{"id":1238278,"sourceID":1238297,"targetID":1238292},"1238279":{"id":1238279,"sourceID":1238295,"targetID":1238293}},"notes":{"1238288":{"id":1238288,"x":1194,"y":51,"width":194,"height":163,"text":"Add Derived Fields (Business Logic)","colour":"e6e63c"},"1238289":{"id":1238289,"x":404,"y":48,"width":403,"height":166,"text":"Datatype cleansing and validation","colour":"e6e63c"},"1238290":{"id":1238290,"x":879,"y":48,"width":282,"height":165,"text":"De-duplicate","colour":"e6e63c"},"1238291":{"id":1238291,"x":1416,"y":49,"width":297,"height":169,"text":"Rewrite temp table tmp_flight_data, since it will be used in a couple of places","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Prep Flights","description":null,"type":"TRANSFORMATION","tag":"54952894-3917-4e7a-9eb2-954cb625ac5b"}}