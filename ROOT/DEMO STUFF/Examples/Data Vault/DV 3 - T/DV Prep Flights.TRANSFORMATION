{"job":{"components":{"1231944":{"id":1231944,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":962,"y":162,"width":32,"height":32,"inputConnectorIDs":[1231956],"outputConnectorIDs":[1231960],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add dup counter"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"ux_flightnum\", \"ux_origin\", \"ux_dest\", \"ux_date\", \"ux_deptime\"\n                   ORDER BY \"ux_flightnum\")"},"2":{"slot":2,"type":"STRING","value":"dup_seq"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231945":{"id":1231945,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1296,"y":160,"width":32,"height":32,"inputConnectorIDs":[1231958],"outputConnectorIDs":[1231962],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Delayed Flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"sched_dep\" IS NULL OR \"sched_arr\" IS NULL\n          THEN false\n     WHEN \"actual_dep\" IS NULL OR \"actual_arr\" IS NULL\n          THEN false\n     WHEN TO_NUMBER(\"actual_arr\") - TO_NUMBER(\"sched_arr\") > 15\n     \t  THEN true\n     ELSE\n          false\nEND"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231948":{"id":1231948,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":752,"y":160,"width":32,"height":32,"inputConnectorIDs":[1231957],"outputConnectorIDs":[1231956],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter valid only"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dq_indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231949":{"id":1231949,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":128170095,"x":1468,"y":160,"width":32,"height":32,"inputConnectorIDs":[1231962],"outputConnectorIDs":[1231953],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rename 0"}}}},"visible":true},"2":{"slot":2,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ux_flightnum"},"2":{"slot":2,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"ux_origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"ux_dest"},"2":{"slot":2,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"ux_date"},"2":{"slot":2,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"ux_deptime"},"2":{"slot":2,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"plane_tailnum"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231950":{"id":1231950,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1120,"y":160,"width":32,"height":32,"inputConnectorIDs":[1231960],"outputConnectorIDs":[1231958],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove dups"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"dup_seq"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231952":{"id":1231952,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":483,"y":164,"width":32,"height":32,"inputConnectorIDs":[1231963],"outputConnectorIDs":[1231959],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calculate derived fields"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRIM(\"flightnum\")"},"2":{"slot":2,"type":"STRING","value":"ux_flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"\"origin\""},"2":{"slot":2,"type":"STRING","value":"ux_origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"\"dest\""},"2":{"slot":2,"type":"STRING","value":"ux_dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CONCAT(\"year\", '-', LPAD(\"month\",2,0), '-', LPAD(\"dayofmonth\",2,0))"},"2":{"slot":2,"type":"STRING","value":"ux_date"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"LPAD(COALESCE(\"crsdeptime\",REPLACE(\"deptime\",'NA','0')),4,0)"},"2":{"slot":2,"type":"STRING","value":"ux_deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"COALESCE(TRIM(\"tailnum\"), '')"},"2":{"slot":2,"type":"STRING","value":"plane_tailnum"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"crsdeptime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"deptime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(\"crsarrtime\",4,0))"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"TO_CHAR(LPAD(REPLACE(\"arrtime\",'NA','0'),4,0))"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231954":{"id":1231954,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1631,"y":159,"width":32,"height":32,"inputConnectorIDs":[1231953],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rewrite Table 0"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1231955":{"id":1231955,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":624,"y":160,"width":32,"height":32,"inputConnectorIDs":[1231959],"outputConnectorIDs":[1231957],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Must have a business key"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"ux_flightnum\" IS NOT NULL\n      AND \"ux_origin\" IS NOT NULL\n      AND \"ux_dest\" IS NOT NULL\n      AND \"ux_date\" IS NOT NULL\n      AND \"ux_deptime\" IS NOT NULL\n     THEN 1\n     ELSE 0\nEND"},"2":{"slot":2,"type":"STRING","value":"dq_indicator"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232000":{"id":1232000,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":242,"y":157,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1231963],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"raw_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"year"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"month"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"dayofmonth"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"crsdeptime"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"arrtime"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"crsarrtime"}}},"11":{"slot":11,"values":{"1":{"slot":1,"type":"STRING","value":"tailnum"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1231953":{"id":1231953,"sourceID":1231949,"targetID":1231954},"1231956":{"id":1231956,"sourceID":1231948,"targetID":1231944},"1231957":{"id":1231957,"sourceID":1231955,"targetID":1231948},"1231958":{"id":1231958,"sourceID":1231950,"targetID":1231945},"1231959":{"id":1231959,"sourceID":1231952,"targetID":1231955},"1231960":{"id":1231960,"sourceID":1231944,"targetID":1231950},"1231962":{"id":1231962,"sourceID":1231945,"targetID":1231949},"1231963":{"id":1231963,"sourceID":1232000,"targetID":1231952}},"notes":{"1231940":{"id":1231940,"x":879,"y":48,"width":282,"height":165,"text":"De-duplicate","colour":"e6e63c"},"1231941":{"id":1231941,"x":1416,"y":49,"width":297,"height":169,"text":"Rewrite temp table tmp_flight_data, since it will be used in a couple of places","colour":"e6e63c"},"1231946":{"id":1231946,"x":1194,"y":51,"width":194,"height":163,"text":"Add Derived Fields (Business Logic)","colour":"e6e63c"},"1231947":{"id":1231947,"x":404,"y":48,"width":403,"height":166,"text":"Datatype cleansing and validation","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Prep Flights","description":null,"type":"TRANSFORMATION","tag":"6cf37035-94a9-400d-a914-fecb298088d6"}}