{"job":{"components":{"1232151":{"id":1232151,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":512,"y":396,"width":32,"height":32,"inputConnectorIDs":[1232180],"outputConnectorIDs":[1232176],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Last Known"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"latest_ind"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232152":{"id":1232152,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1088,"y":272,"width":32,"height":32,"inputConnectorIDs":[1232182],"outputConnectorIDs":[1232181],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add reference columns"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TO_TIMESTAMP_NTZ(CURRENT_TIMESTAMP())"},"2":{"slot":2,"type":"STRING","value":"load_timestamp"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"'S3'"},"2":{"slot":2,"type":"STRING","value":"record_source"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232153":{"id":1232153,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":160,"y":398,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1232183],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s_flight"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s_flight"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"load_timestamp"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232154":{"id":1232154,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":880,"y":264,"width":32,"height":32,"inputConnectorIDs":[1232177],"outputConnectorIDs":[1232182],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"New or Changed"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"N"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"C"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"OR"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232155":{"id":1232155,"inputCardinality":"TWO","outputCardinality":"MANY","implementationID":-359894709,"x":657,"y":264,"width":32,"height":32,"inputConnectorIDs":[1232176,1232179],"outputConnectorIDs":[1232177],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Detect Changes 0"}}}},"visible":true},"2":{"slot":2,"name":"Master Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Last Known"}}}},"visible":true},"3":{"slot":3,"name":"Match Keys","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_sk"}}}},"visible":true},"4":{"slot":4,"name":"Compare Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"}}}},"visible":true},"5":{"slot":5,"name":"Output Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"master_sched_dep"},"2":{"slot":2,"type":"STRING","value":"master_sched_dep"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_sched_dep"},"2":{"slot":2,"type":"STRING","value":"compare_sched_dep"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"master_actual_dep"},"2":{"slot":2,"type":"STRING","value":"master_actual_dep"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_actual_dep"},"2":{"slot":2,"type":"STRING","value":"compare_actual_dep"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"master_sched_arr"},"2":{"slot":2,"type":"STRING","value":"master_sched_arr"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_sched_arr"},"2":{"slot":2,"type":"STRING","value":"compare_sched_arr"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"master_actual_arr"},"2":{"slot":2,"type":"STRING","value":"master_actual_arr"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"compare_actual_arr"},"2":{"slot":2,"type":"STRING","value":"compare_actual_arr"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"compare_delayed_flag"},"2":{"slot":2,"type":"STRING","value":"compare_delayed_flag"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"master_delayed_flag"},"2":{"slot":2,"type":"STRING","value":"master_delayed_flag"}}}},"visible":true},"6":{"slot":6,"name":"Indicator Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Indicator"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232156":{"id":1232156,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":336,"y":208,"width":32,"height":32,"inputConnectorIDs":[1232186,1232187],"outputConnectorIDs":[1232179],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Current attributes"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"i"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"h_flight"},"2":{"slot":2,"type":"STRING","value":"f"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"i\".\"flightnum\" = \"f\".\"flightnum\"\nAND \"i\".\"origin\" = \"f\".\"origin\"\nAND \"i\".\"dest\" = \"f\".\"dest\"\nAND \"i\".\"flightdate\" = \"f\".\"flightdate\"\nAND \"i\".\"deptime\" = \"f\".\"deptime\""},"2":{"slot":2,"type":"STRING","value":"i_Inner_f"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f.sk"},"2":{"slot":2,"type":"STRING","value":"flight_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"i.sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"i.actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"i.sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"i.actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"i.delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232157":{"id":1232157,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":166,"y":266,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1232187],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"h_flight"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"h_flight"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232158":{"id":1232158,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":154,"y":158,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1232186],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"tmp_flight_data"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flightnum"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"dest"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"flightdate"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"deptime"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"sched_dep"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"actual_dep"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"sched_arr"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"actual_arr"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"delayed_flag"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232159":{"id":1232159,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1267,"y":270,"width":32,"height":32,"inputConnectorIDs":[1232181],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append s_flight"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"s_flight"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_sk"},"2":{"slot":2,"type":"STRING","value":"flight_sk"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"compare_sched_dep"},"2":{"slot":2,"type":"STRING","value":"sched_dep"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"compare_actual_dep"},"2":{"slot":2,"type":"STRING","value":"actual_dep"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"compare_sched_arr"},"2":{"slot":2,"type":"STRING","value":"sched_arr"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"compare_actual_arr"},"2":{"slot":2,"type":"STRING","value":"actual_arr"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"compare_delayed_flag"},"2":{"slot":2,"type":"STRING","value":"delayed_flag"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"load_timestamp"},"2":{"slot":2,"type":"STRING","value":"load_timestamp"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"record_source"},"2":{"slot":2,"type":"STRING","value":"record_source"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1232178":{"id":1232178,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":336,"y":403,"width":32,"height":32,"inputConnectorIDs":[1232183],"outputConnectorIDs":[1232180],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Order by Date"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ROW_NUMBER() OVER (PARTITION BY \"flight_sk\" ORDER BY \"load_timestamp\" DESC)"},"2":{"slot":2,"type":"STRING","value":"latest_ind"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1232176":{"id":1232176,"sourceID":1232151,"targetID":1232155},"1232177":{"id":1232177,"sourceID":1232155,"targetID":1232154},"1232179":{"id":1232179,"sourceID":1232156,"targetID":1232155},"1232180":{"id":1232180,"sourceID":1232178,"targetID":1232151},"1232181":{"id":1232181,"sourceID":1232152,"targetID":1232159},"1232182":{"id":1232182,"sourceID":1232154,"targetID":1232152},"1232183":{"id":1232183,"sourceID":1232153,"targetID":1232178},"1232186":{"id":1232186,"sourceID":1232158,"targetID":1232156},"1232187":{"id":1232187,"sourceID":1232157,"targetID":1232156}},"notes":{"1232109":{"id":1232109,"x":266,"y":149,"width":194,"height":114,"text":"Surrogate Key lookup against Hub table","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"DV Xforms s_flight","description":null,"type":"TRANSFORMATION","tag":"c25823a8-76a4-46ae-a6f7-2b0d6676956c"}}